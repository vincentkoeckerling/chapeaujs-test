{"version":3,"file":"chapeau.js","sources":["../src/yt_embed.js","../src/gm_embed.js","../src/main.js"],"sourcesContent":["import \"./yt_embed.css\";\n\nconst videoHTML = `\n\t\t<iframe class=\"c-video__iframe\" style=\"display: none\" frameborder=\"0\" allow=\"fullscreen\"></iframe>\n\t\t<img class=\"c-video__thumbnail\">\n\t\t<div class=\"c-video__overlay\">\n\t\t\t<a href=\"#\" class=\"c-video__button w-button\">Video laden</a>\n\t\t\t<span class=\"c-video__text\">\n\t\t\tDas Video wird von YouTube eingebettet.<br>\n\t\t\tEs gelten die\n\t\t\t<a class=\"c-video__link\" href=\"https://policies.google.com/privacy?hl=de\"\n\t\t\t\ttarget=\"_blank\">Datenschutzerklärungen</a>\n\t\t\tvon Google.\n\t\t\t</span>\n\t\t</div>\n\t`;\n\nlet videos;\n\nexport function initialize() {\n\t// Convert all embedded YT-Elements\n\tArray.from(document.querySelectorAll(\".w-richtext-figure-type-video > div, .w-embed-youtubevideo\")).forEach((el) => {\n\t\tconst url = el.querySelector(\"iframe\").src;\n\t\tel.setAttribute(\"c-video\", \"\");\n\t\tel.setAttribute(\"data-url\", url);\n\t});\n\n\tvideos = Array.from(document.querySelectorAll(\"[c-video]\")).map(createVideo);\n\n\tconst accept = sessionStorage.getItem(\"c-accept_yt\");\n\tif (accept == \"true\") {\n\t\tloadVideos();\n\t}\n}\n\nexport function loadVideos() {\n\tvideos.forEach((video) => video.load());\n\n\tsessionStorage.setItem(\"c-accept_yt\", true);\n}\n\n/** @param {HTMLElement} $el */\nfunction createVideo($el) {\n\t$el.classList.add(\"c-video\");\n\t$el.innerHTML = videoHTML;\n\n\tconst $iframe = $el.querySelector(\".c-video .c-video__iframe\");\n\tconst $thumbnail = $el.querySelector(\".c-video .c-video__thumbnail\");\n\tconst $overlay = $el.querySelector(\".c-video .c-video__overlay\");\n\tconst $link = $el.querySelector(\".c-video .c-video__link\");\n\n\tconst url = $el.dataset.url;\n\tconst videoId = getIdFromUrl(url);\n\n\tconst hasThumbnail = $el.dataset.thumbnail != null;\n\tif (hasThumbnail) {\n\t\t$thumbnail.src = $el.dataset.thumbnail;\n\t} else {\n\t\t$thumbnail.src = `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`;\n\t\t// Check if maxresredefault thumbnail is available\n\t\t$thumbnail.addEventListener(\"load\", () => {\n\t\t\tif ($thumbnail.naturalHeight <= 90) {\n\t\t\t\t// Fallback image from YT is 120x90\n\t\t\t\t$thumbnail.src = `http://img.youtube.com/vi/${videoId}/sddefault.jpg`; // Standard thumbnail\n\t\t\t}\n\t\t});\n\t}\n\n\t$overlay.addEventListener(\"click\", () => loadVideos());\n\t$link.addEventListener(\"click\", (e) => e.stopPropagation());\n\n\t// Remove padding-top if webflow yt-embed\n\tif ($el.classList.contains(\"w-embed-youtubevideo\")) {\n\t\t$el.style.paddingTop = null;\n\t}\n\n\tfunction load() {\n\t\tconst embedUrl = `https://www.youtube-nocookie.com/embed/${videoId}`;\n\n\t\t$iframe.src = embedUrl;\n\n\t\t$iframe.style.display = null;\n\t\t$thumbnail.style.display = \"none\";\n\t\t$overlay.style.display = \"none\";\n\t}\n\n\treturn {\n\t\tload,\n\t};\n}\n\nfunction getIdFromUrl(urlString) {\n\tconst url = new URL(urlString);\n\tlet videoId = url.searchParams.get(\"v\"); // Full URL\n\tif (!videoId) {\n\t\tvideoId = url.pathname.split(\"/\").slice(-1); // Short URL\n\t}\n\n\treturn videoId;\n}\n","const mapHTML = `\n\t\t<iframe class=\"c-map__iframe\" style=\"display: none\" frameborder=\"0\" allow=\"fullscreen\" referrerpolicy=\"no-referrer-when-downgrade\" loading=\"lazy\"></iframe>\n\t\t<div class=\"c-map__overlay\">\n\t\t\t<a href=\"#\" class=\"c-map__button w-button\">Karte laden</a>\n\t\t\t<p class=\"c-map__text\">\n\t\t\tDie Karte wird von Google Maps eingebettet.<br>\n\t\t\tEs gelten die \n\t\t\t<a class=\"c-map__link\" href=\"https://policies.google.com/privacy?hl=de\"\n\t\t\t\ttarget=\"_blank\">Datenschutzerklärungen</a>\n\t\t\tvon Google.\n\t\t\t</p>\n\t\t</div>\n\t\t`;\n\n/** @param {HTMLElement} $el */\nfunction createMap($el) {\n\t$el.classList.add(\"c-map\");\n\t$el.innerHTML = mapHTML;\n\n\tconst $iframe = $el.querySelector(\".c-map .c-map__iframe\");\n\tconst $overlay = $el.querySelector(\".c-map .c-map__overlay\");\n\tconst $link = $el.querySelector(\".c-map .c-map__link\");\n\n\tconst url = $el.dataset.url;\n\n\t$overlay.addEventListener(\"click\", () => loadMaps());\n\t$link.addEventListener(\"click\", (e) => e.stopPropagation());\n\n\tfunction load() {\n\t\t$iframe.src = url;\n\n\t\t$iframe.style.display = null;\n\t\t$overlay.style.display = \"none\";\n\t}\n\n\treturn {\n\t\tload,\n\t};\n}\n\nArray.from(document.querySelectorAll('[c-map=\"iframe\"]')).forEach((el) => {\n\tconst url = el.querySelector(\"iframe\").src;\n\tel.setAttribute(\"data-url\", url);\n});\n\nconst maps = Array.from(document.querySelectorAll(\"[c-map]\")).map(createMap);\nfunction loadMaps() {\n\tmaps.forEach((map) => map.load());\n\n\tsessionStorage.setItem(\"c-accept_gm\", true);\n}\n\nconst accept = sessionStorage.getItem(\"c-accept_gm\");\nif (accept == \"true\") {\n\tloadMaps();\n}\n\nexport { loadMaps };\n","import * as YtEmbed from \"./yt_embed.js\";\nimport { loadMaps } from \"./gm_embed.js\";\n\nfunction main() {\n\tconst isDevAlreadyActive = window.CHAPEAU_DEV;\n\tif (isDevAlreadyActive) return;\n\n\tif (import.meta.env.DEV) {\n\t\twindow.CHAPEAU_DEV = true;\n\t}\n\n\tYtEmbed.initialize();\n}\n\nmain();\n\nexport default {\n\tloadVideos: YtEmbed.loadVideos,\n\tloadMaps,\n};\n"],"names":["videoHTML","videos","initialize","el","url","createVideo","loadVideos","video","$el","$iframe","$thumbnail","$overlay","$link","videoId","getIdFromUrl","e","load","embedUrl","urlString","mapHTML","createMap","loadMaps","maps","map","main","YtEmbed.initialize","YtEmbed.loadVideos"],"mappings":"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"}