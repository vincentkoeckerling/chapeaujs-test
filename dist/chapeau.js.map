{"version":3,"file":"chapeau.js","sources":["../src/yt_embed.js","../src/gm_embed.js"],"sourcesContent":["import \"./yt_embed.css\";\n\nconst videoHTML = `\n\t\t<iframe class=\"c-video__iframe\" style=\"display: none\" frameborder=\"0\" allow=\"fullscreen\"></iframe>\n\t\t<img class=\"c-video__thumbnail\">\n\t\t<div class=\"c-video__overlay\">\n\t\t\t<a href=\"#\" class=\"c-video__button w-button\">Video laden</a>\n\t\t\t<span class=\"c-video__text\">\n\t\t\tDas Video wird von YouTube eingebettet.<br>\n\t\t\tEs gelten die\n\t\t\t<a class=\"c-video__link\" href=\"https://policies.google.com/privacy?hl=de\"\n\t\t\t\ttarget=\"_blank\">Datenschutzerklärungen</a>\n\t\t\tvon Google.\n\t\t\t</span>\n\t\t</div>\n\t`;\n\nfunction getIdFromUrl(urlString) {\n\tconst url = new URL(urlString);\n\tlet videoId = url.searchParams.get(\"v\"); // Full URL\n\tif (!videoId) {\n\t\tvideoId = url.pathname.split(\"/\").slice(-1); // Short URL\n\t}\n\n\treturn videoId;\n}\n\n/** @param {HTMLElement} $el */\nfunction createVideo($el) {\n\t$el.classList.add(\"c-video\");\n\t$el.innerHTML = videoHTML;\n\n\tconst $iframe = $el.querySelector(\".c-video .c-video__iframe\");\n\tconst $thumbnail = $el.querySelector(\".c-video .c-video__thumbnail\");\n\tconst $overlay = $el.querySelector(\".c-video .c-video__overlay\");\n\tconst $link = $el.querySelector(\".c-video .c-video__link\");\n\n\tconst url = $el.dataset.url;\n\tconst videoId = getIdFromUrl(url);\n\n\tconst hasThumbnail = $el.dataset.thumbnail != null;\n\tif (hasThumbnail) {\n\t\t$thumbnail.src = $el.dataset.thumbnail;\n\t} else {\n\t\t$thumbnail.src = `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`;\n\t\t// Check if maxresredefault thumbnail is available\n\t\t$thumbnail.addEventListener(\"load\", () => {\n\t\t\tif ($thumbnail.naturalHeight <= 90) {\n\t\t\t\t// Fallback image from YT is 120x90\n\t\t\t\t$thumbnail.src = `http://img.youtube.com/vi/${videoId}/sddefault.jpg`; // Standard thumbnail\n\t\t\t}\n\t\t});\n\t}\n\n\t$overlay.addEventListener(\"click\", () => loadVideos());\n\t$link.addEventListener(\"click\", (e) => e.stopPropagation());\n\n\t// Remove padding-top if webflow yt-embed\n\tif ($el.classList.contains(\"w-embed-youtubevideo\")) {\n\t\t$el.style.paddingTop = null;\n\t}\n\n\tfunction load() {\n\t\tconst embedUrl = `https://www.youtube-nocookie.com/embed/${videoId}`;\n\n\t\t$iframe.src = embedUrl;\n\n\t\t$iframe.style.display = null;\n\t\t$thumbnail.style.display = \"none\";\n\t\t$overlay.style.display = \"none\";\n\t}\n\n\treturn {\n\t\tload,\n\t};\n}\n\n// Convert all embedded YT-Elements\nArray.from(document.querySelectorAll(\".w-richtext-figure-type-video > div, .w-embed-youtubevideo\")).forEach((el) => {\n\tconst url = el.querySelector(\"iframe\").src;\n\tel.setAttribute(\"c-video\", \"\");\n\tel.setAttribute(\"data-url\", url);\n});\n\nconst videos = Array.from(document.querySelectorAll(\"[c-video]\")).map(createVideo);\nfunction loadVideos() {\n\tvideos.forEach((video) => video.load());\n\n\tsessionStorage.setItem(\"c-accept_yt\", true);\n}\n\nconst accept = sessionStorage.getItem(\"c-accept_yt\");\nif (accept == \"true\") {\n\tloadVideos();\n}\n\nexport { loadVideos };\n","const mapHTML = `\n\t\t<iframe class=\"c-map__iframe\" style=\"display: none\" frameborder=\"0\" allow=\"fullscreen\" referrerpolicy=\"no-referrer-when-downgrade\" loading=\"lazy\"></iframe>\n\t\t<div class=\"c-map__overlay\">\n\t\t\t<a href=\"#\" class=\"c-map__button w-button\">Karte laden</a>\n\t\t\t<p class=\"c-map__text\">\n\t\t\tDie Karte wird von Google Maps eingebettet.<br>\n\t\t\tEs gelten die \n\t\t\t<a class=\"c-map__link\" href=\"https://policies.google.com/privacy?hl=de\"\n\t\t\t\ttarget=\"_blank\">Datenschutzerklärungen</a>\n\t\t\tvon Google.\n\t\t\t</p>\n\t\t</div>\n\t\t`;\n\n/** @param {HTMLElement} $el */\nfunction createMap($el) {\n\t$el.classList.add(\"c-map\");\n\t$el.innerHTML = mapHTML;\n\n\tconst $iframe = $el.querySelector(\".c-map .c-map__iframe\");\n\tconst $overlay = $el.querySelector(\".c-map .c-map__overlay\");\n\tconst $link = $el.querySelector(\".c-map .c-map__link\");\n\n\tconst url = $el.dataset.url;\n\n\t$overlay.addEventListener(\"click\", () => Chapeau.loadMaps());\n\t$link.addEventListener(\"click\", (e) => e.stopPropagation());\n\n\tfunction load() {\n\t\t$iframe.src = url;\n\n\t\t$iframe.style.display = null;\n\t\t$overlay.style.display = \"none\";\n\t}\n\n\treturn {\n\t\tload,\n\t};\n}\n\nArray.from(document.querySelectorAll('[c-map=\"iframe\"]')).forEach((el) => {\n\tconst url = el.querySelector(\"iframe\").src;\n\tel.setAttribute(\"data-url\", url);\n});\n\nconst maps = Array.from(document.querySelectorAll(\"[c-map]\")).map(createMap);\nfunction loadMaps() {\n\tmaps.forEach((map) => map.load());\n\n\tsessionStorage.setItem(\"c-accept_gm\", true);\n}\n\nconst accept = sessionStorage.getItem(\"c-accept_gm\");\nif (accept == \"true\") {\n\tloadMaps();\n}\n\nexport { loadMaps };\n"],"names":["videoHTML","getIdFromUrl","urlString","url","videoId","createVideo","$el","$iframe","$thumbnail","$overlay","$link","loadVideos","e","load","embedUrl","el","videos","video","mapHTML","createMap","maps","loadMaps","map"],"mappings":"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"}